<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
  <div class="container-fluid">
    <a class="navbar-brand" href="#">Dashboard</a>
    <button
      class="navbar-toggler"
      type="button"
      data-bs-toggle="collapse"
      data-bs-target="#navbarNav"
      aria-controls="navbarNav"
      aria-expanded="false"
      aria-label="Toggle navigation"
    >
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link active" aria-current="page" href="#">Home</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">Features</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">Pricing</a>
        </li>
        <li class="nav-item">
          <a class="nav-link disabled" tabindex="-1" aria-disabled="true"
          >Disabled</a
          >
        </li>
      </ul>
    </div>
  </div>
</nav>



<div class="container mt-4">
  <h1>Welcome to the distance-based HHI index calculation!</h1>

  <div class="mb-3">
    <label for="textSelector" class="form-label">Choose a market from your favorites:</label>
    <select
      class="form-select"
      id="textSelector"
      [(ngModel)]="selectedText"
      (change)="updateMarker()"
    >
      <option *ngFor="let option of textOptions" [value]="option">
        {{ option }}
      </option>
    </select>
  </div>
  <div class="alert alert-info" *ngIf="selectedText">
    <strong>Ausgewählter Text:</strong> {{ selectedText }}
  </div>





  <div class="input-group mb-3">
  <span class="input-group-text" id="inputGroup-sizing-default">
    Search location
  </span>
    <input
      type="text"
      #searchBox
      class="form-control"
      placeholder="Please enter location..."
      aria-label="search box"
      aria-describedby="inputGroup-sizing-default"
    />
  </div>



  <div class="container mt-4">
    <div class="row">

      <!-- Linke Seite: Supermarkt-Info-Box (Nur sichtbar, wenn ein Supermarkt ausgewählt ist) -->
      <div class="col-md-6">
        <div *ngIf="selectedSupermarket" class="card shadow-lg border-0 mb-3">

          <!-- Card Header: Supermarkt Name -->
          <div class="card-header bg-primary text-white text-center">
            <h5 class="mb-0">{{ selectedSupermarket.name }}</h5>
          </div>

          <!-- Supermarkt Bild -->
          <div *ngIf="selectedSupermarket.photos" class="text-center mt-3">
            <img
              [src]="selectedSupermarket.photos[0].getUrl({ maxWidth: 600 })"
              class="rounded shadow"
              alt="Supermarkt-Bild"
              style="max-width: 90%; height: auto;"
            />
          </div>

          <!-- Card Body -->
          <div class="card-body">
            <p><strong>📍 Adresse:</strong> {{ selectedSupermarket.formatted_address }}</p>

            <p *ngIf="selectedSupermarket.rating">
              ⭐ <strong>Bewertung:</strong> {{ selectedSupermarket.rating }}/5
              ({{ selectedSupermarket.user_ratings_total }} Rezensionen)
            </p>

            <div *ngIf="selectedSupermarket.opening_hours">
              <p class="mb-1"><strong>🕒 Öffnungszeiten:</strong></p>
              <ul class="list-unstyled mb-2">
                <li *ngFor="let day of selectedSupermarket.opening_hours.weekday_text">
                  {{ day }}
                </li>
              </ul>
            </div>

            <p *ngIf="selectedSupermarket.price_level">
              💰 <strong>Preiskategorie:</strong> {{ '$'.repeat(selectedSupermarket.price_level) }}
            </p>

            <p *ngIf="selectedSupermarket.website">
              🌍 <a [href]="selectedSupermarket.website" target="_blank" class="text-decoration-none">Offizielle Website</a>
            </p>

            <p *ngIf="selectedSupermarket.url">
              🔗 <a [href]="selectedSupermarket.url" target="_blank" class="text-decoration-none">Auf Google Maps ansehen</a>
            </p>

            <p *ngIf="selectedSupermarket.international_phone_number">
              ☎ <a [href]="'tel:' + selectedSupermarket.international_phone_number" class="text-decoration-none">
              {{ selectedSupermarket.international_phone_number }}
            </a>
            </p>

            <p *ngIf="selectedSupermarket.business_status === 'CLOSED_TEMPORARILY'">
              ⚠ <strong class="text-danger">Dieser Supermarkt ist vorübergehend geschlossen!</strong>
            </p>

            <p *ngIf="selectedSupermarket.permanently_closed">
              ❌ <strong class="text-danger">Dauerhaft geschlossen</strong>
            </p>
          </div>
        </div>
      </div>

      <!-- Rechte Seite: Switches (Immer sichtbar) -->
      <div class="col-md-6">
        <div class="card p-3 shadow mb-4">
          <h5>Filter & Optionen</h5>

          <!-- Markenfilter -->
          <div class="d-flex flex-wrap gap-3">
            <div class="form-check form-switch">
              <input class="form-check-input" type="checkbox" id="Aldi" [(ngModel)]="selectedBrands['Aldi']">
              <label class="form-check-label" for="Aldi">Aldi 🛒</label>
            </div>
            <div class="form-check form-switch">
              <input class="form-check-input" type="checkbox" id="Lidl" [(ngModel)]="selectedBrands['Lidl']">
              <label class="form-check-label" for="Lidl">Lidl 🛒</label>
            </div>
            <div class="form-check form-switch">
              <input class="form-check-input" type="checkbox" id="REWE" [(ngModel)]="selectedBrands['REWE']">
              <label class="form-check-label" for="REWE">REWE 🛒</label>
            </div>
            <div class="form-check form-switch">
              <input class="form-check-input" type="checkbox" id="Netto" [(ngModel)]="selectedBrands['Netto']">
              <label class="form-check-label" for="Netto">Netto 🛒</label>
            </div>
          </div>

          <!-- Abstand zwischen den Switch-Gruppen -->
          <div class="mt-3 d-flex flex-wrap gap-3">
            <!-- Stadt/Land Switch -->
            <div class="form-check form-switch">
              <input
                class="form-check-input"
                type="checkbox"
                id="maxTimeSwitch"
                [(ngModel)]="isRuralArea"
                (change)="updateMaxTravelTime()"
              >
              <label class="form-check-label" for="maxTimeSwitch">
                🏙️ Stadt (10 Min) / 🌄 Land (15 Min)
              </label>
            </div>

            <!-- TravelMode Switch -->
            <div class="form-check form-switch">
              <input
                class="form-check-input"
                type="checkbox"
                id="travelModeSwitch"
                [(ngModel)]="travelModes['WALKING']"
                (change)="updateTravelMode()"
              >
              <label class="form-check-label" for="travelModeSwitch">🚶‍♂️ Zu Fuß / 🚗 Auto</label>
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>




  <div class="mb-3">
    <button
      type="button"
      class="btn btn-primary btn-lg d-block w-100"
      (click)="searchNearbySupermarkets()"
    >
      Find Competitors
    </button>

  </div>

  <div class="mb-3">
    <button
      type="button"
      class="btn btn-primary btn-lg d-block w-100"
      (click)="calculateHHI()"
    >
      Calculate HHI
    </button>

  </div>

  <!-- Karte -->

  <div id="map" style="width: 100%; height: 400px;"></div>

  <div class="mt-3">
    <h3>Ergebnisse:</h3>

    <div>
      <h2>Herfindahl-Hirschman-Index (HHI)</h2>
      <p>{{ sumOfSquaredMarketShares }}</p>
    </div>

    <p *ngIf="errorMessage" class="text-danger">{{ errorMessage }}</p>
  </div>
</div>

